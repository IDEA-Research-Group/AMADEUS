# vul_description: In F5 BIG_IP LTM, AAM, AFM, Analytics, APM, ASM, DNS, Link Controller, PEM and WebSafe software version 13.0.0 and 12.1.0 _ 12.1.2, race conditions in iControl REST may lead to commands being executed with different privilege levels than expected.

%Relationships 
CVE_2017_6167: types sources exploits f5;

types: application;
sources: nvd;

exploits: [direct] [indirect];
f5: [1,1] {f5_big_ip__local__traffic__manager f5_big_ip__application__acceleration__manager f5_big_ip__advanced__firewall__manager f5_big_ip__analytics f5_big_ip__access__policy__manager f5_big_ip__application__security__manager f5_big_ip__dns f5_big_ip__link__controller f5_big_ip__policy__enforcement__manager f5_big_ip__websafe};

f5_big_ip__local__traffic__manager: f5_big_ip__local__traffic__manager_version f5_big_ip__local__traffic__manager_update;
f5_big_ip__application__acceleration__manager: f5_big_ip__application__acceleration__manager_version f5_big_ip__application__acceleration__manager_update;
f5_big_ip__advanced__firewall__manager: f5_big_ip__advanced__firewall__manager_version f5_big_ip__advanced__firewall__manager_update;
f5_big_ip__analytics: f5_big_ip__analytics_version f5_big_ip__analytics_update;
f5_big_ip__access__policy__manager: f5_big_ip__access__policy__manager_version f5_big_ip__access__policy__manager_update;
f5_big_ip__application__security__manager: f5_big_ip__application__security__manager_version f5_big_ip__application__security__manager_update;
f5_big_ip__dns: f5_big_ip__dns_version;
f5_big_ip__link__controller: f5_big_ip__link__controller_version f5_big_ip__link__controller_update;
f5_big_ip__policy__enforcement__manager: f5_big_ip__policy__enforcement__manager_version f5_big_ip__policy__enforcement__manager_update;
f5_big_ip__websafe: f5_big_ip__websafe_version;

f5_big_ip__local__traffic__manager_version: [1,1] {f5_big_ip__local__traffic__manager_version_12__1__0 f5_big_ip__local__traffic__manager_version_12__1__1 f5_big_ip__local__traffic__manager_version_13__0__0 f5_big_ip__local__traffic__manager_version_12__1__2};
f5_big_ip__local__traffic__manager_update: [1,1] {f5_big_ip__local__traffic__manager_update_hotfix2 f5_big_ip__local__traffic__manager_update_any f5_big_ip__local__traffic__manager_update_hotfix1};
f5_big_ip__application__acceleration__manager_version: [1,1] {f5_big_ip__application__acceleration__manager_version_12__1__2 f5_big_ip__application__acceleration__manager_version_12__1__1 f5_big_ip__application__acceleration__manager_version_13__0__0 f5_big_ip__application__acceleration__manager_version_12__1__0};
f5_big_ip__application__acceleration__manager_update: [1,1] {f5_big_ip__application__acceleration__manager_update_hotfix2 f5_big_ip__application__acceleration__manager_update_any f5_big_ip__application__acceleration__manager_update_hotfix1};
f5_big_ip__advanced__firewall__manager_version: [1,1] {f5_big_ip__advanced__firewall__manager_version_12__1__2 f5_big_ip__advanced__firewall__manager_version_12__1__1 f5_big_ip__advanced__firewall__manager_version_13__0__0 f5_big_ip__advanced__firewall__manager_version_12__1__0};
f5_big_ip__advanced__firewall__manager_update: [1,1] {f5_big_ip__advanced__firewall__manager_update_hotfix2 f5_big_ip__advanced__firewall__manager_update_any f5_big_ip__advanced__firewall__manager_update_hotfix1};
f5_big_ip__analytics_version: [1,1] {f5_big_ip__analytics_version_12__1__0 f5_big_ip__analytics_version_12__1__1 f5_big_ip__analytics_version_13__0__0 f5_big_ip__analytics_version_12__1__2};
f5_big_ip__analytics_update: [1,1] {f5_big_ip__analytics_update_hotfix2 f5_big_ip__analytics_update_any f5_big_ip__analytics_update_hotfix1};
f5_big_ip__access__policy__manager_version: [1,1] {f5_big_ip__access__policy__manager_version_12__1__0 f5_big_ip__access__policy__manager_version_12__1__1 f5_big_ip__access__policy__manager_version_13__0__0 f5_big_ip__access__policy__manager_version_12__1__2};
f5_big_ip__access__policy__manager_update: [1,1] {f5_big_ip__access__policy__manager_update_hotfix2 f5_big_ip__access__policy__manager_update_any f5_big_ip__access__policy__manager_update_hotfix1};
f5_big_ip__application__security__manager_version: [1,1] {f5_big_ip__application__security__manager_version_12__1__2 f5_big_ip__application__security__manager_version_12__1__1 f5_big_ip__application__security__manager_version_13__0__0 f5_big_ip__application__security__manager_version_12__1__0};
f5_big_ip__application__security__manager_update: [1,1] {f5_big_ip__application__security__manager_update_hotfix2 f5_big_ip__application__security__manager_update_any f5_big_ip__application__security__manager_update_hotfix1};
f5_big_ip__dns_version: [1,1] {f5_big_ip__dns_version_12__1__2 f5_big_ip__dns_version_12__1__1 f5_big_ip__dns_version_13__0__0 f5_big_ip__dns_version_12__1__0};
f5_big_ip__link__controller_version: [1,1] {f5_big_ip__link__controller_version_12__1__0 f5_big_ip__link__controller_version_12__1__1 f5_big_ip__link__controller_version_13__0__0 f5_big_ip__link__controller_version_12__1__2};
f5_big_ip__link__controller_update: [1,1] {f5_big_ip__link__controller_update_hotfix2 f5_big_ip__link__controller_update_any f5_big_ip__link__controller_update_hotfix1};
f5_big_ip__policy__enforcement__manager_version: [1,1] {f5_big_ip__policy__enforcement__manager_version_12__1__2 f5_big_ip__policy__enforcement__manager_version_12__1__1 f5_big_ip__policy__enforcement__manager_version_13__0__0 f5_big_ip__policy__enforcement__manager_version_12__1__0};
f5_big_ip__policy__enforcement__manager_update: [1,1] {f5_big_ip__policy__enforcement__manager_update_hotfix2 f5_big_ip__policy__enforcement__manager_update_any f5_big_ip__policy__enforcement__manager_update_hotfix1};
f5_big_ip__websafe_version: [1,1] {f5_big_ip__websafe_version_12__1__0 f5_big_ip__websafe_version_12__1__1 f5_big_ip__websafe_version_13__0__0 f5_big_ip__websafe_version_12__1__2};



%Constraints 
f5_big_ip__local__traffic__manager REQUIRES application;
f5_big_ip__application__acceleration__manager REQUIRES application;
f5_big_ip__advanced__firewall__manager REQUIRES application;
f5_big_ip__analytics REQUIRES application;
f5_big_ip__access__policy__manager REQUIRES application;
f5_big_ip__application__security__manager REQUIRES application;
f5_big_ip__dns REQUIRES application;
f5_big_ip__link__controller REQUIRES application;
f5_big_ip__policy__enforcement__manager REQUIRES application;
f5_big_ip__websafe REQUIRES application;
f5_big_ip__local__traffic__manager_version_12__1__0 REQUIRES f5_big_ip__local__traffic__manager_update_any;
f5_big_ip__local__traffic__manager_version_12__1__1 IMPLIES ((f5_big_ip__local__traffic__manager_update_hotfix2 AND NOT f5_big_ip__local__traffic__manager_update_any) OR (NOT f5_big_ip__local__traffic__manager_update_hotfix2 AND f5_big_ip__local__traffic__manager_update_any));
f5_big_ip__local__traffic__manager_version_13__0__0 REQUIRES f5_big_ip__local__traffic__manager_update_any;
f5_big_ip__local__traffic__manager_version_12__1__2 IMPLIES ((f5_big_ip__local__traffic__manager_update_any AND NOT f5_big_ip__local__traffic__manager_update_hotfix1) OR (NOT f5_big_ip__local__traffic__manager_update_any AND f5_big_ip__local__traffic__manager_update_hotfix1));
f5_big_ip__application__acceleration__manager_version_12__1__2 IMPLIES ((f5_big_ip__application__acceleration__manager_update_any AND NOT f5_big_ip__application__acceleration__manager_update_hotfix1) OR (NOT f5_big_ip__application__acceleration__manager_update_any AND f5_big_ip__application__acceleration__manager_update_hotfix1));
f5_big_ip__application__acceleration__manager_version_12__1__1 IMPLIES ((f5_big_ip__application__acceleration__manager_update_hotfix2 AND NOT f5_big_ip__application__acceleration__manager_update_any) OR (NOT f5_big_ip__application__acceleration__manager_update_hotfix2 AND f5_big_ip__application__acceleration__manager_update_any));
f5_big_ip__application__acceleration__manager_version_13__0__0 REQUIRES f5_big_ip__application__acceleration__manager_update_any;
f5_big_ip__application__acceleration__manager_version_12__1__0 REQUIRES f5_big_ip__application__acceleration__manager_update_any;
f5_big_ip__advanced__firewall__manager_version_12__1__2 IMPLIES ((f5_big_ip__advanced__firewall__manager_update_any AND NOT f5_big_ip__advanced__firewall__manager_update_hotfix1) OR (NOT f5_big_ip__advanced__firewall__manager_update_any AND f5_big_ip__advanced__firewall__manager_update_hotfix1));
f5_big_ip__advanced__firewall__manager_version_12__1__1 IMPLIES ((f5_big_ip__advanced__firewall__manager_update_hotfix2 AND NOT f5_big_ip__advanced__firewall__manager_update_any) OR (NOT f5_big_ip__advanced__firewall__manager_update_hotfix2 AND f5_big_ip__advanced__firewall__manager_update_any));
f5_big_ip__advanced__firewall__manager_version_13__0__0 REQUIRES f5_big_ip__advanced__firewall__manager_update_any;
f5_big_ip__advanced__firewall__manager_version_12__1__0 REQUIRES f5_big_ip__advanced__firewall__manager_update_any;
f5_big_ip__analytics_version_12__1__0 REQUIRES f5_big_ip__analytics_update_any;
f5_big_ip__analytics_version_12__1__1 IMPLIES ((f5_big_ip__analytics_update_hotfix2 AND NOT f5_big_ip__analytics_update_any) OR (NOT f5_big_ip__analytics_update_hotfix2 AND f5_big_ip__analytics_update_any));
f5_big_ip__analytics_version_13__0__0 REQUIRES f5_big_ip__analytics_update_any;
f5_big_ip__analytics_version_12__1__2 IMPLIES ((f5_big_ip__analytics_update_any AND NOT f5_big_ip__analytics_update_hotfix1) OR (NOT f5_big_ip__analytics_update_any AND f5_big_ip__analytics_update_hotfix1));
f5_big_ip__access__policy__manager_version_12__1__0 REQUIRES f5_big_ip__access__policy__manager_update_any;
f5_big_ip__access__policy__manager_version_12__1__1 IMPLIES ((f5_big_ip__access__policy__manager_update_hotfix2 AND NOT f5_big_ip__access__policy__manager_update_any) OR (NOT f5_big_ip__access__policy__manager_update_hotfix2 AND f5_big_ip__access__policy__manager_update_any));
f5_big_ip__access__policy__manager_version_13__0__0 REQUIRES f5_big_ip__access__policy__manager_update_any;
f5_big_ip__access__policy__manager_version_12__1__2 IMPLIES ((f5_big_ip__access__policy__manager_update_any AND NOT f5_big_ip__access__policy__manager_update_hotfix1) OR (NOT f5_big_ip__access__policy__manager_update_any AND f5_big_ip__access__policy__manager_update_hotfix1));
f5_big_ip__application__security__manager_version_12__1__2 IMPLIES ((f5_big_ip__application__security__manager_update_any AND NOT f5_big_ip__application__security__manager_update_hotfix1) OR (NOT f5_big_ip__application__security__manager_update_any AND f5_big_ip__application__security__manager_update_hotfix1));
f5_big_ip__application__security__manager_version_12__1__1 IMPLIES ((f5_big_ip__application__security__manager_update_hotfix2 AND NOT f5_big_ip__application__security__manager_update_any) OR (NOT f5_big_ip__application__security__manager_update_hotfix2 AND f5_big_ip__application__security__manager_update_any));
f5_big_ip__application__security__manager_version_13__0__0 REQUIRES f5_big_ip__application__security__manager_update_any;
f5_big_ip__application__security__manager_version_12__1__0 REQUIRES f5_big_ip__application__security__manager_update_any;
f5_big_ip__link__controller_version_12__1__0 REQUIRES f5_big_ip__link__controller_update_any;
f5_big_ip__link__controller_version_12__1__1 IMPLIES ((f5_big_ip__link__controller_update_hotfix2 AND NOT f5_big_ip__link__controller_update_any) OR (NOT f5_big_ip__link__controller_update_hotfix2 AND f5_big_ip__link__controller_update_any));
f5_big_ip__link__controller_version_13__0__0 REQUIRES f5_big_ip__link__controller_update_any;
f5_big_ip__link__controller_version_12__1__2 IMPLIES ((f5_big_ip__link__controller_update_any AND NOT f5_big_ip__link__controller_update_hotfix1) OR (NOT f5_big_ip__link__controller_update_any AND f5_big_ip__link__controller_update_hotfix1));
f5_big_ip__policy__enforcement__manager_version_12__1__2 IMPLIES ((f5_big_ip__policy__enforcement__manager_update_any AND NOT f5_big_ip__policy__enforcement__manager_update_hotfix1) OR (NOT f5_big_ip__policy__enforcement__manager_update_any AND f5_big_ip__policy__enforcement__manager_update_hotfix1));
f5_big_ip__policy__enforcement__manager_version_12__1__1 IMPLIES ((f5_big_ip__policy__enforcement__manager_update_hotfix2 AND NOT f5_big_ip__policy__enforcement__manager_update_any) OR (NOT f5_big_ip__policy__enforcement__manager_update_hotfix2 AND f5_big_ip__policy__enforcement__manager_update_any));
f5_big_ip__policy__enforcement__manager_version_13__0__0 REQUIRES f5_big_ip__policy__enforcement__manager_update_any;
f5_big_ip__policy__enforcement__manager_version_12__1__0 REQUIRES f5_big_ip__policy__enforcement__manager_update_any;
